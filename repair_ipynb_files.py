# -*- coding: utf-8 -*-
"""Repair_ipynb_files.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1tXMKmRvG5u5vpl2NRbOawIirSiFvAwi_
"""









import os
import nbformat

def modify_notebook(file_path):
    try:
        # قراءة ملف الـ Notebook
        with open(file_path, 'r', encoding='utf-8') as f:
            notebook = nbformat.read(f, as_version=4)

        # التحقق من وجود metadata.widgets
        if 'widgets' in notebook.get('metadata', {}):
            print(f"Modifying widgets in: {file_path}")
            # حذف قسم widgets
            del notebook['metadata']['widgets']

        # حفظ التعديلات
        with open(file_path, 'w', encoding='utf-8') as f:
            nbformat.write(notebook, f)
        print(f"Modified and saved: {file_path}")
    except Exception as e:
        print(f"Error modifying {file_path}: {e}")

def modify_all_notebooks_in_directory(directory):
    for root, _, files in os.walk(directory):
        for file in files:
            if file.endswith('.ipynb'):
                file_path = os.path.join(root, file)
                modify_notebook(file_path)

if __name__ == "__main__":
    # تحديد المسار إلى المجلد الذي يحتوي على ملفات Jupyter Notebook
    directory = input("Enter the directory containing notebooks: ")
    modify_all_notebooks_in_directory(directory)